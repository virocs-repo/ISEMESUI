<div class="k-d-flex k-align-items-center k-gap-4 k-py-2 k-px-4 page-header">
  <kendo-label text="Search All Columns" class="k-font-size-sm k-d-flex k-align-items-center">
    <input kendoTextBox [(ngModel)]="searchText" (ngModelChange)="onSearchTextChange()" type="text"
      placeholder="Type to search across all columns..." style="width: 300px;" />
  </kendo-label>
  <kendo-label text="Active" class="k-font-size-sm k-d-flex k-align-items-center">
    <kendo-checkbox [(ngModel)]="selectedActive" (ngModelChange)="loadGridData()" class="k-ml-2"></kendo-checkbox>
  </kendo-label>
  <div class="k-ml-auto k-d-flex k-gap-2">
    <button kendoButton rounded="full" themeColor="info" (click)="openAddDialog()">Add</button>
    <button kendoButton rounded="full" (click)="onClear()">Clear</button>
  </div>
</div>
<div class="k-m-4">
  <kendo-grid
    [kendoGridBinding]="gridDataResult.data"
    [selectable]="selectableSettings"
    [columnMenu]="columnMenuSettings"
    [filterable]="true"
    [sortable]="true"
    [resizable]="true"
    [pageSize]="pageSize"
    [skip]="skip"
    [pageable]="{
      buttonCount: 5,
      info: true,
      type: 'numeric',
      pageSizes: [25, 50, 100],
      previousNext: true
    }"
    (pageChange)="pageChange($event)"
    (cellClick)="onCellClick($event)"
    class="inventory-grid"
    [rowClass]="rowCallback">
    <kendo-grid-column title="Actions" [width]="120" [locked]="false">
      <ng-template kendoGridCellTemplate let-dataItem>
        <div class="k-d-flex k-gap-2">
          <button kendoButton size="small" themeColor="primary" [svgIcon]="ICON.pencilIcon" 
            (click)="onEdit(dataItem)" title="Edit"></button>
          <button kendoButton size="small" themeColor="info" [svgIcon]="ICON.eyeIcon" 
            (click)="onView(dataItem)" title="View"></button>
        </div>
      </ng-template>
    </kendo-grid-column>
    <kendo-grid-column *ngFor="let c of columnData" [field]="c.field" [title]="c.title" [width]="c.width">
      <ng-template kendoGridCellTemplate let-dataItem>
        <span class="truncate-text" [title]="dataItem?.[c.field] || ''">
          {{ dataItem?.[c.field] || '' }}
        </span>
      </ng-template>
    </kendo-grid-column>
  </kendo-grid>
</div>

<!-- Add/Edit Dialog -->
<kendo-dialog
  *ngIf="isDialogOpen"
  (close)="closeDialog()"
  [minWidth]="250"
  [width]="'68%'"
  class="dialog-round">
  <div class="k-d-flex k-align-items-center k-mb-3">
    <h2 class="k-m-0">{{ isViewMode ? 'View Device Family' : (isEditMode ? 'Edit Device Family' : 'Add Device Family') }}</h2>
    <button kendoButton type="button" rounded="full" class="k-ml-auto" [svgIcon]="ICON.xIcon" size="small"
      (click)="closeDialog()"></button>
  </div>
  <div class="k-d-flex k-flex-column k-gap-3 k-p-4">
    <kendo-label text="Customer *" class="k-font-size-sm">
      <input *ngIf="isViewMode" kendoTextBox [value]="getCustomerName(deviceFamilyData.customerID)" type="text"
        class="w-100" readonly />
      <kendo-combobox
        *ngIf="!isViewMode"
        [data]="customersList"
        [valuePrimitive]="true"
        [textField]="'CustomerName'"
        [valueField]="'CustomerID'"
        [(ngModel)]="deviceFamilyData.customerID"
        [filterable]="true"
        [kendoDropDownFilter]="filterSettings"
        [allowCustom]="false"
        [popupSettings]="{ width: 'auto', height: 300, appendTo: 'component' }"
        [disabled]="false"
        placeholder="Select or type to search customer..."
        class="w-100">
        <ng-template kendoComboBoxNoDataTemplate>
          <div class="k-p-2">No customer found</div>
        </ng-template>
      </kendo-combobox>
    </kendo-label>
    <kendo-label text="Device Family Name *" class="k-font-size-sm">
      <input kendoTextBox [(ngModel)]="deviceFamilyData.deviceFamilyName" type="text"
        placeholder="Enter Device Family Name" class="w-100" [readonly]="isViewMode" />
    </kendo-label>
    <kendo-label text="Active" class="k-font-size-sm">
      <kendo-switch [(ngModel)]="deviceFamilyData.isActive" [disabled]="isViewMode || !isEditMode"></kendo-switch>
    </kendo-label>
    <div class="k-d-flex k-justify-content-end k-gap-2 k-mt-3" *ngIf="!isViewMode">
      <button kendoButton (click)="closeDialog()">Cancel</button>
      <button kendoButton themeColor="primary" (click)="saveDeviceFamily()">Save</button>
    </div>
    <div class="k-d-flex k-justify-content-end k-gap-2 k-mt-3" *ngIf="isViewMode">
      <button kendoButton (click)="closeDialog()">Close</button>
    </div>
  </div>
</kendo-dialog>
